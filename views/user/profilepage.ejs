<% layout('./layouts/boillerplate') -%>
    <div class="mx-6 sm:mx-auto sm:w-1/2">
        <p class="text-2xl font-bold my-4">Your Profile</p>
        <form action="/profile/<%= data.id %>?_method=PUT" method="POST" enctype="multipart/form-data">
            <div class="mb-5 flex flex-col  items-center justify-center p-2 ">
                <% if (!data.image || !data.image.path) { %>
                    <img class="h-40 w-40 object-cover rounded-full border-2 border-black" id="imagePreview"
                        src="https://images.unsplash.com/photo-1633332755192-727a05c4013d?w=500&auto=format&fit=crop&q=60&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8dXNlcnxlbnwwfHwwfHx8MA%3D%3D"
                        alt="userImage">
                <% } else { %>
                    <img class="h-40 w-40 object-cover  rounded-full border-2 border-black" id="imagePreview"
                        src="<%= data.image.path %>"
                        alt="userImage">
                <% } %>
                 
                <label for="imageInput" class="bg-gray-800 hover:bg-gray-900 rounded-lg  block mb-2 text-sm font-medium text-white py-2 my-2 px-4">Upload Image</label>
                <input type="file" id="imageInput"
                    class="hidden bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full "
                    name="image" />
            </div>

            <div class="mb-5">
                <label for="name" class="block mb-2 text-sm font-medium text-black">Your Name</label>
                <input type="text" id="name" value="<%= data.username %>"
                    class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 "
                     placeholder="Add a Name" readonly />
            </div>
            <div class="mb-5">
                <label for="email" class="block mb-2 text-sm font-medium text-black">Your Email</label>
                <input type="email" id="email" value="<%= data.email %>"
                    class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 "
                    name="email" placeholder="Your Email"  />
            </div>
            <button type="submit"
                class="text-white bg-gray-800 hover:bg-gray-900 focus:outline-none focus:ring-4 focus:ring-gray-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2">Submit</button>

        </form>
        <p class="text-sm text-red-600 my-4 font-medium">**Note:You can only change the photo and email </p>

    </div>


    <script>
        // Function to handle file selection and preview
        function previewImage(event) {
            const input = event.target;
            const reader = new FileReader();

            reader.onload = function () {
                const preview = document.getElementById('imagePreview');
                preview.classList.remove("hidden");
                preview.src = reader.result;
            }

            if (input.files && input.files[0]) {
                const fileSize = input.files[0].size; // File size in bytes
                const maxSize = 2 * 1024 * 1024; // 2 MB

                if (fileSize > maxSize) {
                    alert('File size exceeds 2 MB limit.');
                    input.value = ''; // Clear input value
                    document.getElementById('imagePreview').src = '#'; // Clear preview
                } else {
                    reader.readAsDataURL(input.files[0]); // Read the file and preview
                }
            }
        }

        // Event listener for file input change
        document.getElementById('imageInput').addEventListener('change', previewImage);
    </script>